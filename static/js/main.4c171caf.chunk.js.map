{"version":3,"sources":["cacluator/qr_code.webp","cacluator/Home.js","cacluator/util.js","index.js"],"names":["Title","Typography","Text","Home","useState","inputListForPrint","setInputListForPrint","targetValueForPrint","setTargetValueForPrint","resultListForPrint","setResultListForPrint","calculator","useCallback","inputList","targetValue","calculateType","resultList","depth","length","tempPath","currentMaxOrMin","checkMax","value","i","list","forEach","p","index","push","total","every","v","sort","toString","checkMin","search","calculateResult","style","margin","title","display","name","wrapperCol","span","onFinish","values","restInput","Object","filter","parseFloat","map","k","console","log","JSON","stringify","autoComplete","padding","width","level","Item","initialValue","Group","buttonStyle","Button","formList","initForm","type","htmlType","position","right","bottom","zIndex","cursor","content","height","src","qrcode","alt","trigger","color","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.4c171caf.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/qr_code.da49026f.webp\";","import { useCallback, useState } from 'react';\r\nimport { calculateResult } from './util';\r\nimport { Button, Form, Input, Popover, Radio, Tag, Tooltip, Typography } from 'antd';\r\nimport qrcode from './qr_code.webp';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\nconst Home = () => {\r\n\r\n  const [inputListForPrint, setInputListForPrint] = useState([]);\r\n  const [targetValueForPrint, setTargetValueForPrint] = useState(0);\r\n  const [resultListForPrint, setResultListForPrint] = useState([]);\r\n\r\n\r\n  const calculator = useCallback((inputList, targetValue, calculateType) => {\r\n    return calculateResult(inputList, targetValue, calculateType);\r\n  }, []);\r\n\r\n  const submit = (values) => {\r\n    const { targetValue, calculateType, ...restInput } = values;\r\n    const inputList = Object.values(restInput).filter(v => !!v && parseFloat(v) >= 0).map(k => parseFloat(k));\r\n\r\n    if (inputList.length) {\r\n      const resultList = calculator(inputList, targetValue, calculateType);\r\n      console.log('===================================================');\r\n      console.log('发票金额：' + inputList);\r\n      console.log('目标额度：' + targetValue + '元');\r\n      if (resultList.length) {\r\n        resultList.forEach(v => {\r\n          console.log('最接近目标值的组合为 ' + JSON.stringify(v.list) + ' ,合计' + v.total + '元');\r\n        });\r\n      } else {\r\n        console.log('无结果');\r\n      }\r\n\r\n      setInputListForPrint(inputList);\r\n      setTargetValueForPrint(targetValue);\r\n      setResultListForPrint(resultList);\r\n    } else {\r\n      setInputListForPrint([]);\r\n      setTargetValueForPrint(0);\r\n      setResultListForPrint([]);\r\n    }\r\n  };\r\n\r\n  const initForm = () => {\r\n    const formList = [];\r\n    for (let i = 0; i < 21; i += 1) {\r\n      formList.push(\r\n        <Form.Item\r\n          name={'value_' + i}\r\n          style={{ display: 'inline-block', width: '33%' }}\r\n        >\r\n          <Input />\r\n        </Form.Item>\r\n      );\r\n    }\r\n    return formList;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Text\r\n        style={{ margin: 10 }}\r\n      >\r\n        <Tooltip title=\"1214更新：暴力解决三位小数以内的精度问题；反馈渠道图片使用webp格式，调整显示大小\">\r\n          E票M - 发票助手 V 0.9.4\r\n        </Tooltip>\r\n      </Text>\r\n      <div style={{ display: 'flex' }}>\r\n        <Form\r\n          name=\"basic\"\r\n          wrapperCol={{\r\n            span: 18,\r\n          }}\r\n          onFinish={submit}\r\n          autoComplete=\"off\"\r\n          style={{ padding: '4%', width: '50%' }}\r\n        >\r\n          <Title level={4}>\r\n            计算方式\r\n          </Title>\r\n          <Form.Item\r\n            initialValue=\"noMoreThan\"\r\n            name=\"calculateType\"\r\n          >\r\n            <Radio.Group buttonStyle=\"solid\">\r\n              <Radio.Button value=\"noMoreThan\">不超过（交通）</Radio.Button>\r\n              <Radio.Button value=\"noLessThan\">不低于（其他）</Radio.Button>\r\n            </Radio.Group>\r\n          </Form.Item>\r\n          <Title level={4}>\r\n            目标额度\r\n          </Title>\r\n          <Form.Item name=\"targetValue\" style={{ display: 'inline-block', width: '60%' }}>\r\n            <Input />\r\n          </Form.Item>\r\n          <Title level={4}>\r\n            输入发票金额\r\n          </Title>\r\n          {initForm()}\r\n          <Form.Item>\r\n            <Button type=\"primary\" htmlType=\"submit\">\r\n              提交\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n        {inputListForPrint?.length ? (\r\n          <div style={{ padding: '4%', width: '50%' }}>\r\n            <Title level={4}>发票金额：</Title>\r\n            <Title level={5}>{JSON.stringify(inputListForPrint, null, 2)}</Title>\r\n            <br />\r\n            <Title level={4}>目标额度：</Title>\r\n            <Title level={5}>{targetValueForPrint} 元</Title>\r\n            <br />\r\n            <Title level={4}>最接近目标值的组合为：</Title>\r\n            {resultListForPrint.map((v) =>\r\n              (<Title level={5}>{JSON.stringify(v.list, null, 2)}&nbsp;&nbsp;&nbsp;&nbsp;合计 {v.total} 元</Title>)\r\n            )}\r\n            {!resultListForPrint.length && (<Title level={5}>无结果</Title>)}\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n      <div style={{\r\n        position: 'fixed',\r\n        right: 40,\r\n        bottom: 40,\r\n        zIndex: 9999,\r\n        display: 'flex',\r\n        cursor: 'pointer'\r\n      }}>\r\n        <Popover\r\n          content={<img height=\"270\" width=\"270\" src={qrcode} alt=\"给钱啥都好说\" />}\r\n          trigger=\"click\"\r\n        >\r\n          <Tag color=\"#108ee9\">→ 点赞/吐槽/需求/BUG ←</Tag>\r\n        </Popover>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\n\r\nexport default Home;","export function calculateResult(inputList, targetValue, calculateType) {\r\n  let resultList = [];\r\n  let depth = inputList.length;\r\n  let tempPath = [];\r\n  let currentMaxOrMin = 0;\r\n\r\n  const search = (i) => { // 递归深度\r\n    if (i >= depth) {\r\n      if (calculateType === 'noMoreThan') {\r\n        checkMax();\r\n      } else if (calculateType === 'noLessThan') {\r\n        checkMin();\r\n      }\r\n    } else {\r\n      tempPath[i] = 0;\r\n      search(i + 1);\r\n      tempPath[i] = 1;\r\n      search(i + 1);\r\n    }\r\n  };\r\n\r\n  const checkMax = () => {\r\n    let value = 0;\r\n    for (let i = 0; i < depth; i++) {\r\n      if (tempPath[i] === 1) {\r\n        value = (value * 1000 + inputList[i] * 1000) / 1000;\r\n      }\r\n    }\r\n    // 不高于（交通）\r\n    if (value > 0 && value <= targetValue) {\r\n      let list = [];\r\n      tempPath.forEach((p, index) => {\r\n        if (p === 1) {\r\n          list.push(inputList[index]);\r\n        }\r\n      });\r\n      if (value > currentMaxOrMin) {\r\n        resultList = [{ total: value, list }];\r\n        currentMaxOrMin = value;\r\n      } else if (value === currentMaxOrMin) {\r\n        if (resultList.every((v) => v.list.sort().toString() !== list.sort().toString())) {\r\n          resultList.push({ total: value, list });\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const checkMin = () => {\r\n    let value = 0;\r\n    for (let i = 0; i < depth; i++) {\r\n      if (tempPath[i] === 1) {\r\n        value = (value * 1000 + inputList[i] * 1000) / 1000;\r\n      }\r\n    }\r\n    // 不低于（租房）\r\n    if (value >= targetValue) {\r\n      let list = [];\r\n      tempPath.forEach((p, index) => {\r\n        if (p === 1) {\r\n          list.push(inputList[index]);\r\n        }\r\n      });\r\n\r\n      if (!currentMaxOrMin || value < currentMaxOrMin) {\r\n        resultList = [{ total: value, list }];\r\n        currentMaxOrMin = value;\r\n      } else if (value === currentMaxOrMin) {\r\n        if (resultList.every((v) => v.list.sort().toString() !== list.sort().toString())) {\r\n          resultList.push({ total: value, list });\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  search(0);\r\n  return resultList;\r\n}\r\n\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Home from './cacluator/Home';\r\nimport 'antd/dist/antd.css'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Home />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}